<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Write & Read Google Sheet</title>
  <style>
    body { font-family: sans-serif; width: 400px; margin: 30px auto; }
    input, textarea { width: 100%; padding: 8px; margin: 5px 0; }
    button { padding: 10px 15px; margin-top: 10px; cursor: pointer; }
    pre { background: #eee; padding: 10px; }
  </style>
</head>
<body>

<h2>Tulis ke Spreadsheet</h2>

<input id="name" placeholder="Nama">
<input id="email" placeholder="Email">
<textarea id="note" placeholder="Catatan"></textarea>

<button onclick="writeData()">Submit</button>

<p id="result"></p>

<hr>

<h2>Cek Data Spreadsheet</h2>
<button onclick="loadData()">Load Data</button>

<pre id="output"></pre>

<script>
  const API_URL = "https://script.google.com/macros/s/AKfycbyObCRCcebzJp2sd9aKzeNxEak738Sfij7xqfc2Xld4JmYLSVTm41N3qRNWYSlIBsg_/exec";

  async function writeData() {
    const payload = {
      name: document.getElementById("name").value,
      email: document.getElementById("email").value,
      note: document.getElementById("note").value
    };

    const res = await fetch(API_URL, {
      method: "POST",
      body: JSON.stringify(payload),
      headers: { "Content-Type": "application/json" }
    });

    const json = await res.json();
    document.getElementById("result").innerText =
      json.success ? "Berhasil menulis!" : "Gagal!";
  }

  async function loadData() {
    const res = await fetch(API_URL);
    const json = await res.json();
    document.getElementById("output").innerText =
      JSON.stringify(json, null, 2);
  }
</script>

</body>
</html>
